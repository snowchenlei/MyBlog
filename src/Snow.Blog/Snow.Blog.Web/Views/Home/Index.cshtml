@{
    ViewData["Title"] = "Home Page";
}
@model Snow.Blog.Web.Models.Home.IndexModel

@section Style{
    <environment include="Development">
        <link href="~/css/Calendar.css" rel="stylesheet" asp-append-version="true" />
        <link href="~/view-resources/Home/index.css" rel="stylesheet" asp-append-version="true" />
    </environment>
    <environment exclude="Development">
    </environment>
}
<div class="container">
    <div class="row">
        <div class="col">
            <div style="position: sticky;top: 70px;">
                <div class="sidebar">
                    <div class="sidebar-title">随笔分类</div>
                    @foreach (KeyValuePair<int, string> kPair in Model.Categories)
                    {
                        <div class="sidebar-item" data-val="@kPair.Key" title="@kPair.Value"><a href="~/Home/Index?categoryId=@kPair.Key">@kPair.Value</a></div>
                    }
                </div>
            </div>
        </div>
        <div class="col-8">
            <!--正文列表内容-->
            <div id="content">
                @await Component.InvokeAsync("BloggerList", new { categoryId = Model.Page })
            </div>
            @*<div id="body"></div>*@
            <!--分页-->
            <div id="pagination"></div>
            <a id="replaceHref" style="display: none;" asp-controller="Blogger" asp-action="List" asp-route-page="2"
               data-ajax="true" data-ajax-method="GET" data-ajax-mode="replace"
               data-ajax-update="#content" class="mypager page-link">1</a>
        </div>
        <div class="col">
            <!--其它内容-->
            <canvas id="canvas" style="width: 100%;"></canvas>
            <div class='calendar' style="width: 100%;" id='calendar'></div>
            <div style="height: 1000px;"></div>
        </div>
    </div>
</div>
<input type="hidden" id="categoryId" />

@section Script{
    <script src="~/js/clock.js"></script>
    <script src="~/js/Calendar.js"></script>
    <script src="~/lib/jquery.unobtrusive-ajax/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/lib/jquery.twbsPagination/jquery.twbsPagination.js"></script>
    <script type="text/javascript">
        $(function () {
            var page = getStartPage();
            window.pagObj = $('#pagination').twbsPagination({
                hideOnlyOnePage: true,  //当总数为一页时，不显示分页
                startPage: page,
                totalPages: 35,
                visiblePages: 10,
                first: '首页',
                last: '末页',
                prev: '上一页',
                next: '下一页',
                pageVariable: 'page',//地址栏替换参数
                //href: true,//页面跳转
                onPageClick: function (event, page) {
                    $('#replaceHref').attr('href', '/Blogger/List?page=' + page);
                    $('#replaceHref')[0].click();
                }
            }).on('page', function (event, page) {
                console.info(page + ' (from event listening)');
            });
        });
        function getStartPage() {
            var page = 1;
            var hash = window.location.hash;
            if (hash.indexOf('-') > 0) {
                page = parseInt(hash.substr(hash.indexOf('-') + 1));
            }
            return page;
        }
    </script>
}